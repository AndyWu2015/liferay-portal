import com.liferay.gradle.plugins.css.builder.BuildCSSTask

apply plugin: "com.liferay.css.builder"
apply plugin: "java"

task runGradleTest

repositories {
	maven {
		url "https://cdn.lfrs.sl/repository.liferay.com/nexus/content/groups/public"
	}
}

task editCSS(type: BuildCSSTask) {
	doFirst {
		// edit the file
		File fooCss = file("src/main/resources/css/imports/_foo.scss")
		fooCss.text = "body { background: yellow; }"
	}
}

runGradleTest {
	dependsOn classes, editCSS

	doLast {
		File dir = file("src/main/resources/css/.sass-cache")

		for (String fileName in ["main.css", "main_rtl.css"]) {
			File generatedFile = new File(dir, fileName)

			assert generatedFile.exists()

			assert generatedFile.text.contains("yellow")
		}
	}
}